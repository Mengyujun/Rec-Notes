# 双塔召回



## 基础知识

**背景**： 召回场景的候选集很大，无法对大规模的数据进行在线serve, 因此需要牺牲精度换取延迟 

**模型结构**：

- 离线训练时：
  - user和item特征**分别单独**输入DNN，得到user embedding与item embedding
  - 将最后一层embedding计算cosine（下文会详细介绍为什么要用余弦距离）得到logit 来进行训练
  -  训练完成后分别保存user塔和item塔模型参数，user塔用来做online serving ， item塔用来离线生成item向量构建faiss索引
- 在线serve时： 
  - 获得用户请求之后，抽取用户特征，在线过一遍模型，得到user-embedding 
  - 利用向量检索工具（faiss，annoy等），将离线item-embedding输入faiss，建立索引，用user-embedding来进行最近邻top-k 检索。
  - 返回top-k 的itemid 作为召回的结果



**优缺点**： 

- 





现在双塔召回： 

cosine 以及 归一化等操作还没有进行 



















































### 学习链接

双塔召回模型的前世今生（上篇） - iwtbs的文章 - 知乎 https://zhuanlan.zhihu.com/p/430503952

